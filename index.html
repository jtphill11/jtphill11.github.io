<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bullride | Wall Street at Home</title>

    <!-- Foundation CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.4.3/css/foundation.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/motion-ui/1.2.3/motion-ui.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.4.3/css/foundation-prototype.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/foundicons/3.0.0/foundation-icons.css" rel="stylesheet" type="text/css">

    <!-- Amplify -->
    <script src="https://unpkg.com/aws-amplify@5.0.7/dist/aws-amplify.min.js"></script>

    <style>
      /* Optional: style the custom login form */
      #customLogin {
        margin-top: 20px;
      }
      #customLogin input {
        margin-bottom: 10px;
      }
      #loginError {
        color: red;
        margin-top: 5px;
      }
    </style>
  </head>

  <body>
    <!-- Sidebar -->
    <div class="off-canvas position-left reveal-for-large" id="my-info" data-off-canvas>
      <div class="grid-y grid-padding-x" style="height: 100%;">
        <br>
        <div class="cell shrink">
          <img class="thumbnail" src="assets/bullride_logo.png" alt="Bullride Logo">
        </div>
        <div class="cell auto">
          <input type="button" class="button expanded" id="showSignIn" value="Log In">
          <input type="button" class="button expanded" id="showSignUp" value="Sign Up">
          <p>Log in to view, buy, sell, and create your very own ETF baskets, or create an account for free today!</p>

          <!-- Custom Login / Sign-up Forms -->
          <div id="customLogin" style="display:none;">
            <form id="loginForm">
              <label>Email
                <input type="text" id="email" placeholder="Enter your email" required>
              </label>
              <label>Password
                <input type="password" id="password" placeholder="Enter your password" required>
              </label>
              <button type="submit" class="button expanded">Log In</button>
              <p id="loginError"></p>
            </form>
          </div>

          <div id="customSignUp" style="display:none;">
            <form id="signUpForm">
              <label>Email
                <input type="text" id="signUpEmail" placeholder="Enter your email" required>
              </label>
              <label>Password
                <input type="password" id="signUpPassword" placeholder="Enter your password" required>
              </label>
              <button type="submit" class="button expanded">Sign Up</button>
              <p id="signUpError"></p>
            </form>
          </div>

        </div>
      </div>
    </div>

    <!-- Main Content -->
    <div class="off-canvas-content" data-off-canvas-content>
      <div class="title-bar hide-for-large">
        <div class="title-bar-left">
          <button class="menu-icon" type="button" data-toggle="my-info"></button>
          <span class="title-bar-title">Bullride</span>
        </div>
      </div>

      <div class="callout primary">
        <article class="grid-container">
          <div>
            <h1>Welcome to Bullride, The Spotify of Wall Street.</h1>
            <p class="lead">
              Introducing a revolutionary way to invest in the market. Create your own ETFs, share them, or use AI-generated baskets. 
              This project is currently in development.
            </p>
          </div>
        </article>
      </div>

      <article class="grid-container">
        <!-- ETF icons & early access section omitted for brevity -->
      </article>
    </div>

    <!-- JS Dependencies -->
    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.4.3/js/foundation.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/motion-ui/1.2.3/motion-ui.min.js"></script>

    <!-- Amplify Cognito Integration -->
    <script>
      const { Amplify, Auth } = window.aws_amplify;

      Amplify.configure({
        Auth: {
          region: 'us-east-1',
          userPoolId: 'us-east-1_HPx82G5s7',
          userPoolWebClientId: '2l15ru0njbo72tv2skuceokjf2',
          authenticationFlowType: 'USER_PASSWORD_AUTH'
        }
      });

      // Toggle forms
      const showSignIn = document.getElementById('showSignIn');
      const showSignUp = document.getElementById('showSignUp');
      const customLogin = document.getElementById('customLogin');
      const customSignUp = document.getElementById('customSignUp');

      showSignIn.addEventListener('click', () => {
        customLogin.style.display = 'block';
        customSignUp.style.display = 'none';
      });

      showSignUp.addEventListener('click', () => {
        customLogin.style.display = 'none';
        customSignUp.style.display = 'block';
      });

      // Login form
      const loginForm = document.getElementById('loginForm');
      const loginError = document.getElementById('loginError');

      loginForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;

        try {
          const user = await Auth.signIn(email, password);
          console.log('Login successful:', user);
          window.location.href = '/'; // redirect after login
        } catch (err) {
          console.error('Login error:', err);
          loginError.textContent = err.message || 'Login failed';
        }
      });

      // Sign-up form
      const signUpForm = document.getElementById('signUpForm');
      const signUpError = document.getElementById('signUpError');

      signUpForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const email = document.getElementById('signUpEmail').value;
        const password = document.getElementById('signUpPassword').value;

        try {
          const data = await Auth.signUp({
            username: email,
            password,
            attributes: { email }
          });
          console.log('Sign-up successful:', data);
          signUpError.textContent = 'Sign-up successful! Please check your email to confirm.';
        } catch (err) {
          console.error('Sign-up error:', err);
          signUpError.textContent = err.message || 'Sign-up failed';
        }
      });
    </script>

    <script>
      $(document).foundation();
    </script>
  </body>
</html>
